<div class="card" data-product-id="{{ product.id }}" data-product-handle="{{ product.handle }}">
  <a class="card-media" href="{{ product.url }}">
    {{ product.featured_image | image_url: width: 600 | image_tag: loading: 'lazy', alt: product.title }}
  </a>


  <div class="product-title-detail-addtcart-btn">
<div class="card-header">
    <h1 class="card-title-series "> {{- product.metafields.custom.series.value.letter -}}-{{ product.metafields.custom.series_number }}</h1>
  <h3 class="card-title"><a href="{{ product.url }}">{{ product.title }}</a></h3>
</div>
  {% comment %}{% assign current = product.selected_or_first_available_variant %}

   <form class="card-form" data-product-form>
    {% if product.variants.size > 1 %}
      <div class="variant-radios" role="group" aria-label="Choose an option">
        {% for v in product.variants %}
          <label class="variant-radio">
            <input type="radio"
                   name="id"
                   value="{{ v.id }}"
                   {% if v.id == current.id %}checked{% endif %}
                   {% unless v.available %}disabled{% endunless %}
                   data-price="{{ v.price | money }}">
            <span>{{ v.title }}</span>
          </label>
        {% endfor %}
      </div>
    {% else %}
      <input type="hidden" name="id" value="{{ current.id }}">
    {% endif %}

    <div class="price" data-price>{{ current.price | money }}</div>

    <button type="submit"
            class="add-to-cart"
            {% unless current.available %}disabled{% endunless %}>
      Add to Cart
    </button>
  </form> {% endcomment %}


  {% if product.variants.size > 1 %}
  <!-- <form method="post" action="/cart/add" style="display: flex; flex-direction: column; gap: 10px;" onsubmit="return updateHiddenInput('{{ product.id }}');"> -->

<product-form class="block mediumMax:w-full medium:relative">
      {%- form 'product',
        product,
        id: stickyATCCTAFormID,
        class: 'form',
        novalidate: 'novalidate',
        data-type: 'add-to-cart-form'
      -%}


  
    <div id="variant-options-{{ product.id }}" style="display: flex; gap:10px; align-content:center; justify-content:center">
      {% for variant in product.variants %}
        <label style="display: block; margin-bottom: 5px;">
          <input type="radio"
                 name="variant_{{ product.id }}"
                 value="{{ variant.id }}"
                 data-price="{{ variant.price | money_without_trailing_zeros }}"
                 data-available="{{ variant.available }}"
                 {% if forloop.first %}checked{% endif %}
                 onchange="updatePrice('{{ product.id }}')"
                 style="accent-color: #000;">
          {{ variant.title }}
        </label>
      {% endfor %}
    </div>

    <!-- Hidden input to store the selected variant ID -->
    <input type="hidden" name="id" id="selected-variant-id-{{ product.id }}" value="{{ product.variants.first.id }}">

    <p id="price-display-{{ product.id }}" style="font-weight: bold; text-align:center;margin-bottom:9px;">{{ product.variants.first.price | money_without_trailing_zeros }}</p>

    <button id="add-to-cart-button-{{ product.id }}" type="submit" class="add-to-cart-buttonsss  js-quick-add-context-submit loading-overlay__spinner"
            style=" padding: 10px; margin:0px; background-color: white; cursor: pointer; color: black; font-size:14px; border:1px solid #000;"
            onmouseover="if(!this.disabled){ this.style.color='white'; this.style.backgroundColor='#383838'; }"
            onmouseout="if(!this.disabled){ this.style.color='black'; this.style.backgroundColor='white'; }">
      Add to Cart
    </button>
  {%- endform -%}
      <div
        class="product-form__error-message-wrapper medium:absolute medium:right-0 medium:top-[calc(100%_-_0.625rem)] medium:w-max large:top-[calc(100%_-_7.6825rem)]"
        role="alert"
        hidden
      >
        <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-error" viewBox="0 0 13 13">
          <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"/>
          <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"/>
          <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"/>
          <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7">
        </svg>
        <span class="product-form__error-message"></span>
      </div>
    </product-form>

  <script>
    function updatePrice(productId) {
      var selectedVariant = document.querySelector(`input[name="variant_${productId}"]:checked`);
      var priceDisplay = document.getElementById(`price-display-${productId}`);
      var hiddenInput = document.getElementById(`selected-variant-id-${productId}`);
      var addToCartButton = document.getElementById(`add-to-cart-button-${productId}`);

      if (selectedVariant) {
        priceDisplay.innerHTML = selectedVariant.getAttribute("data-price");
        hiddenInput.value = selectedVariant.value;

        if (selectedVariant.getAttribute("data-available") === "true") {
          addToCartButton.disabled = false;
          addToCartButton.innerText = "Add to Cart";
          addToCartButton.style.backgroundColor = "#fff";
          addToCartButton.style.color = "#000";
          addToCartButton.style.cursor = "pointer";
        } else {
          addToCartButton.disabled = true;
          addToCartButton.innerText = "Out of Stock";
          addToCartButton.style.backgroundColor = "#999";
          addToCartButton.style.color = "#fff";
          addToCartButton.style.border = "1px solid #999";
          addToCartButton.style.cursor = "not-allowed";
        }
      }
    }

    function updateHiddenInput(productId) {
      var selectedVariant = document.querySelector(`input[name="variant_${productId}"]:checked`);
      var hiddenInput = document.getElementById(`selected-variant-id-${productId}`);
      if (selectedVariant) {
        hiddenInput.value = selectedVariant.value;
      }
      return true;
    }

    document.addEventListener("DOMContentLoaded", function() {
      updatePrice('{{ product.id }}');
    });
  </script>

{% else %}
  <!-- <form method="post" action="/cart/add" style="display: flex; flex-direction: column; gap: 10px;"> -->
  <product-form class="block  text-align: center; mediumMax:w-full medium:relative">
      {%- form 'product',
        product,
        id: stickyATCCTAFormID,
        class: 'form',
        novalidate: 'novalidate',
        data-type: 'add-to-cart-form'
      -%}
    <label style="display: block; margin-bottom: 5px; text-align:center;">
      <input type="hidden" name="id" value="{{ product.variants.first.id }}">
      <input type="radio"
             name="variant_id"
             value="{{ product.variants.first.id }}"
             data-price="{{ product.variants.first.price | money_without_trailing_zeros }}"
             checked
             style="accent-color: #000;">
      {{ product.variants.first.title }}
    </label>

    <p style="font-weight: bold; margin-bottom:9px; text-align:center;">{{ product.variants.first.price | money_without_trailing_zeros }}</p>

    {% if product.variants.first.available %}
      <button type="submit"  class="add-to-cart-buttonsss  js-quick-add-context-submit loading-overlay__spinner"
              style="padding: 10px; margin:0px; background-color: #fff; cursor: pointer; color: #000; font-size:14px; border:1px solid #000; "
              onmouseover="this.style.color='white'; this.style.backgroundColor='#383838'"
              onmouseout="this.style.color='black'; this.style.backgroundColor='#fff'">
        Add to Cart
      </button>
    {% else %}
      <button type="button"
              disabled
              style="width:93%; padding: 10px;  background-color: #999; cursor: not-allowed; color: white; font-size:14px; border:1px solid #999;">
        Out of Stock
      </button>
    {% endif %}
    {%- endform -%}
      <div
        class="product-form__error-message-wrapper medium:absolute medium:right-0 medium:top-[calc(100%_-_0.625rem)] medium:w-max large:top-[calc(100%_-_7.6825rem)]"
        role="alert"
        hidden
      >
        <svg aria-hidden="true" focusable="false" role="presentation" class="icon icon-error" viewBox="0 0 13 13">
          <circle cx="6.5" cy="6.50049" r="5.5" stroke="white" stroke-width="2"/>
          <circle cx="6.5" cy="6.5" r="5.5" fill="#EB001B" stroke="#EB001B" stroke-width="0.7"/>
          <path d="M5.87413 3.52832L5.97439 7.57216H7.02713L7.12739 3.52832H5.87413ZM6.50076 9.66091C6.88091 9.66091 7.18169 9.37267 7.18169 9.00504C7.18169 8.63742 6.88091 8.34917 6.50076 8.34917C6.12061 8.34917 5.81982 8.63742 5.81982 9.00504C5.81982 9.37267 6.12061 9.66091 6.50076 9.66091Z" fill="white"/>
          <path d="M5.87413 3.17832H5.51535L5.52424 3.537L5.6245 7.58083L5.63296 7.92216H5.97439H7.02713H7.36856L7.37702 7.58083L7.47728 3.537L7.48617 3.17832H7.12739H5.87413ZM6.50076 10.0109C7.06121 10.0109 7.5317 9.57872 7.5317 9.00504C7.5317 8.43137 7.06121 7.99918 6.50076 7.99918C5.94031 7.99918 5.46982 8.43137 5.46982 9.00504C5.46982 9.57872 5.94031 10.0109 6.50076 10.0109Z" fill="white" stroke="#EB001B" stroke-width="0.7">
        </svg>
        <span class="product-form__error-message"></span>
      </div>
    </product-form>
{% endif %}

</div>
</div>


<style>
    .add-to-cart-buttonsss{
      display: block;
    width: 93%;
    padding: 8px;
    font-size: 14px;
    background-color: black;
    color: black;
    text-align: center;
      border:1px solid #000;

    cursor: pointer;
    /* margin-top: 10px; */
  margin:0px;
    }
  </style>   